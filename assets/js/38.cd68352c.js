(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{156:function(e,a,s){"use strict";s.r(a);var n=s(0),t=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"access-handler"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#access-handler","aria-hidden":"true"}},[e._v("#")]),e._v(" Access handler")]),s("p",[e._v("Algunas veces quieres mostrar o esconder menu items, form fields, etc. para ciertos usuarios, con este componente se puede hacer sin necesidad de condicionales o código boilerplate.")]),s("p",[e._v("Este paquete incluye una clase "),s("code",[e._v("BasicAccessHandler")]),e._v(" pero puedes construir tu propia implementación de "),s("code",[e._v("AccessHandler")]),e._v(".")]),s("h2",{attrs:{id:"basicaccesshandler"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#basicaccesshandler","aria-hidden":"true"}},[e._v("#")]),e._v(" BasicAccessHandler")]),s("p",[e._v("Sólo pasa una de las siguientes opciones como un atributo de campo o valor del menu item:")]),s("ol",[s("li",[s("em",[e._v("callback")]),e._v(": debe devolver true si se quiere dar acceso, false en caso contrario.")]),s("li",[s("em",[e._v("logged")]),e._v(": true: requiere que el usuario esté autenticado, false: requiere usuario invitado.")]),s("li",[s("em",[e._v("roles")]),e._v(": true si el usuario tiene uno de los roles requeridos.")]),s("li",[s("em",[e._v("allows")]),e._v(": usa el método Gate::allows.")]),s("li",[s("em",[e._v("check")]),e._v(": usa el método Gate::check (alias de allow).")]),s("li",[s("em",[e._v("denies")]),e._v(": usa el método Gate::denies.")]),s("li",[e._v("Si ninguna opción es pasada, éste devolverá true (el item será renderizado).")])]),s("p",[s("em",[e._v("WARNING")]),e._v(": tomar en cuenta que este paquete sólo evitará que los elementos aparezcan en el frontend, aún se necesita proteger el acceso de backend usando middleware, etc.")]),s("p",[e._v("Uso:")]),s("p",[e._v("####Form fields")]),s("p",[s("code",[e._v("{!! Field::select('user_id', null, ['roles' => 'admin'])")])]),s("p",[e._v("####Menu items")]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("// config/menu.php\n\nreturn [\n    'items' => [\n        'account' => [\n            'logged' => true\n        ],\n        'login' => [\n            'logged' => false\n        ],\n        'settings' => [\n            'roles' => 'admin'\n        ]\n    ]\n];\n")])])]),s("p",[s("code",[e._v("{!! Menu::make('menu.items') !}}")])]),s("h2",{attrs:{id:"autorizacion-y-politicas-de-acceso"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#autorizacion-y-politicas-de-acceso","aria-hidden":"true"}},[e._v("#")]),e._v(" Autorización y políticas de acceso")]),s("p",[e._v("Las opciones allows, check y denies aceptan un string o un array como valor.")]),s("p",[e._v("Si es un string, será el nombre de la habilidad sin argumentos.")]),s("p",[e._v("Si es un array, la primera posición del array será el nombre de la habilidad y el resto serán los argumentos.")]),s("p",[e._v("Ejemplos:")]),s("p",[s("code",[e._v("{!! Field::text('change-password', ['allows' => 'change-password']) !!}")]),s("code",[e._v("{!! Field::select('category', $options, ['allows' => ['change-post-category', $category]]) !!}")])]),s("p",[e._v("Si estás contruyendo menús puedes usar parámetros dinámicos para pasar valores a la autorización.")]),s("p",[e._v("En el siguiente ejemplo definiremos un parámetro dinámico 'post' y pasarlo usando setParam cuando se construya el menú:")]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("// config/menu.php\n\nreturn [\n    'items' => [\n        'view-post' => [],\n        'edit-post' => [\n            'allows' => ['update-post', ':post']\n        ]\n    ]\n];\n")])])]),s("p",[s("code",[e._v("{!! Menu::make('menu.items')->setParam('post', $post)->render() !}}")])]),s("h2",{attrs:{id:"personalizacion"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#personalizacion","aria-hidden":"true"}},[e._v("#")]),e._v(" Personalización")]),s("p",[e._v("Si estás trabajando en un proyecto complejo con muchas reglas de acceso diferentes, etc. puedes necesitar implementar un  AccessHandler propio. Para hacer esto, crea una nueva clase que implemente la interface "),s("code",[e._v("Styde\\Html\\Access\\AccessHandler")]),e._v(", entonces extiende el HtmlServiceProvider y sustituye el método "),s("code",[e._v("registerAccessHandler")]),e._v(".")]),s("h2",{attrs:{id:"standalone"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#standalone","aria-hidden":"true"}},[e._v("#")]),e._v(" Standalone")]),s("p",[e._v("Si se quiere usar la clase del access handler como un componente independiente, por favor agrega este alias global en "),s("code",[e._v("config/app.php")]),e._v(".")]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("  'aliases' => [\n    // ...\n    'Access' => Styde\\Html\\Facades\\Access,\n    // ...\n  ],\n")])])]),s("p",[e._v("Luego se puede utilizar la facade donde se quiera:")]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("@if (Access:check(['roles' => ['admin, 'editor']]))\n    <p>\n        <a href='{{ url('admin/posts', [$post->id]) }}'>\n            Editar esta página\n        </a>\n    </p>\n@endif\n")])])]),s("p",[e._v("##Desactivar el access handler")]),s("p",[e._v("Se puede desactivar este componente en la configuración:")]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("//config/html.php\nreturn [\n    //..\n    'control_access' => false,\n    //..\n];\n")])])]),s("p",[e._v("Haciendo esto, los atributos callback, logged y roles serán simplemente ignorados, y todos los usuarios serán capaces de ver todos los items.")])])}],!1,null,null,null);a.default=t.exports}}]);